<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de Factures Pro</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background: white;
            border-radius: 20px;
            padding: 50px 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
        }

        .login-title {
            font-size: 28px;
            color: #1a1a2e;
            margin-bottom: 8px;
        }

        .login-subtitle {
            color: #6b7280;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: #374151;
            font-weight: 500;
            font-size: 14px;
        }

        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            background: #f9fafb;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .demo-credentials {
            margin-top: 24px;
            padding: 16px;
            background: #eff6ff;
            border-radius: 10px;
            border-left: 4px solid #3b82f6;
        }

        .demo-credentials h4 {
            font-size: 13px;
            color: #1e40af;
            margin-bottom: 8px;
        }

        .demo-credentials p {
            font-size: 12px;
            color: #1e3a8a;
            margin: 4px 0;
        }

        /* Dashboard */
        .dashboard {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-title {
            font-size: 32px;
            font-weight: 700;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-name {
            font-size: 16px;
            opacity: 0.95;
        }

        .logout-btn {
            padding: 10px 24px;
            background: rgba(255,255,255,0.2);
            border: 2px solid white;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: white;
            color: #667eea;
        }

        .content {
            padding: 40px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #6b7280;
            transition: all 0.3s;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .invoice-form {
            background: #f9fafb;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        .items-table th {
            background: #f3f4f6;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        .items-table td {
            padding: 12px;
            border-top: 1px solid #e5e7eb;
        }

        .items-table input {
            width: 100%;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
        }

        .add-item-btn, .remove-item-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
        }

        .add-item-btn:hover {
            background: #5568d3;
        }

        .remove-item-btn {
            background: #ef4444;
            padding: 6px 12px;
            font-size: 12px;
        }

        .remove-item-btn:hover {
            background: #dc2626;
        }

        .invoice-summary {
            background: white;
            padding: 24px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            font-size: 15px;
        }

        .summary-row.total {
            border-top: 2px solid #e5e7eb;
            margin-top: 10px;
            padding-top: 16px;
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        /* Invoice List */
        .invoice-list {
            display: grid;
            gap: 16px;
        }

        .invoice-card {
            background: white;
            padding: 20px 24px;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .invoice-card:hover {
            border-color: #667eea;
            transform: translateX(4px);
        }

        .invoice-info h3 {
            font-size: 18px;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .invoice-info p {
            color: #6b7280;
            font-size: 14px;
        }

        .invoice-amount {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .items-table {
                font-size: 12px;
            }

            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Login Component
        function LoginPage({ onLogin }) {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                // Simple demo authentication
                if (email && password) {
                    onLogin({ email, name: email.split('@')[0] });
                }
            };

            return (
                <div className="login-container">
                    <div className="login-card">
                        <div className="login-header">
                            <div className="login-logo">üìÑ</div>
                            <h1 className="login-title">G√©n√©rateur de Factures</h1>
                            <p className="login-subtitle">Connectez-vous pour g√©rer vos factures</p>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">Email</label>
                                <input
                                    type="email"
                                    className="form-input"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    placeholder="votre@email.com"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Mot de passe</label>
                                <input
                                    type="password"
                                    className="form-input"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                    required
                                />
                            </div>

                            <button type="submit" className="login-btn">
                                Se connecter
                            </button>
                        </form>

                        <div className="demo-credentials">
                            <h4>üí° Compte de d√©monstration</h4>
                            <p>üìß Email : demo@facture.com</p>
                            <p>üîë Mot de passe : demo123</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Invoice Form Component
        function InvoiceForm({ onSave, onCancel }) {
            const [invoice, setInvoice] = useState({
                number: `INV-${Date.now()}`,
                date: new Date().toISOString().split('T')[0],
                dueDate: '',
                clientName: '',
                clientEmail: '',
                clientAddress: '',
                items: [{ description: '', quantity: 1, price: 0 }],
                notes: ''
            });

            const addItem = () => {
                setInvoice({
                    ...invoice,
                    items: [...invoice.items, { description: '', quantity: 1, price: 0 }]
                });
            };

            const removeItem = (index) => {
                setInvoice({
                    ...invoice,
                    items: invoice.items.filter((_, i) => i !== index)
                });
            };

            const updateItem = (index, field, value) => {
                const newItems = [...invoice.items];
                newItems[index][field] = field === 'description' ? value : parseFloat(value) || 0;
                setInvoice({ ...invoice, items: newItems });
            };

            const calculateSubtotal = () => {
                return invoice.items.reduce((sum, item) => sum + (item.quantity * item.price), 0);
            };

            const calculateTax = () => {
                return calculateSubtotal() * 0.20; // 20% TVA
            };

            const calculateTotal = () => {
                return calculateSubtotal() + calculateTax();
            };

            const handleSave = () => {
                const invoiceData = {
                    ...invoice,
                    subtotal: calculateSubtotal(),
                    tax: calculateTax(),
                    total: calculateTotal()
                };
                onSave(invoiceData);
            };

            return (
                <div>
                    <div className="invoice-form">
                        <div className="form-section">
                            <h3 className="section-title">üìã Informations de la facture</h3>
                            <div className="form-row">
                                <div className="form-group">
                                    <label className="form-label">Num√©ro de facture</label>
                                    <input
                                        type="text"
                                        className="form-input"
                                        value={invoice.number}
                                        onChange={(e) => setInvoice({...invoice, number: e.target.value})}
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Date</label>
                                    <input
                                        type="date"
                                        className="form-input"
                                        value={invoice.date}
                                        onChange={(e) => setInvoice({...invoice, date: e.target.value})}
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Date d'√©ch√©ance</label>
                                    <input
                                        type="date"
                                        className="form-input"
                                        value={invoice.dueDate}
                                        onChange={(e) => setInvoice({...invoice, dueDate: e.target.value})}
                                    />
                                </div>
                            </div>
                        </div>

                        <div className="form-section">
                            <h3 className="section-title">üë§ Informations du client</h3>
                            <div className="form-row">
                                <div className="form-group">
                                    <label className="form-label">Nom du client</label>
                                    <input
                                        type="text"
                                        className="form-input"
                                        value={invoice.clientName}
                                        onChange={(e) => setInvoice({...invoice, clientName: e.target.value})}
                                        placeholder="Nom de l'entreprise ou du client"
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Email</label>
                                    <input
                                        type="email"
                                        className="form-input"
                                        value={invoice.clientEmail}
                                        onChange={(e) => setInvoice({...invoice, clientEmail: e.target.value})}
                                        placeholder="client@example.com"
                                    />
                                </div>
                            </div>
                            <div className="form-group">
                                <label className="form-label">Adresse</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    value={invoice.clientAddress}
                                    onChange={(e) => setInvoice({...invoice, clientAddress: e.target.value})}
                                    placeholder="Adresse compl√®te"
                                />
                            </div>
                        </div>

                        <div className="form-section">
                            <h3 className="section-title">üõí Articles / Services</h3>
                            <table className="items-table">
                                <thead>
                                    <tr>
                                        <th style={{width: '50%'}}>Description</th>
                                        <th style={{width: '15%'}}>Quantit√©</th>
                                        <th style={{width: '20%'}}>Prix unitaire</th>
                                        <th style={{width: '15%'}}>Total</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {invoice.items.map((item, index) => (
                                        <tr key={index}>
                                            <td>
                                                <input
                                                    type="text"
                                                    value={item.description}
                                                    onChange={(e) => updateItem(index, 'description', e.target.value)}
                                                    placeholder="Description de l'article"
                                                />
                                            </td>
                                            <td>
                                                <input
                                                    type="number"
                                                    value={item.quantity}
                                                    onChange={(e) => updateItem(index, 'quantity', e.target.value)}
                                                    min="1"
                                                />
                                            </td>
                                            <td>
                                                <input
                                                    type="number"
                                                    value={item.price}
                                                    onChange={(e) => updateItem(index, 'price', e.target.value)}
                                                    min="0"
                                                    step="0.01"
                                                />
                                            </td>
                                            <td>
                                                <strong>{(item.quantity * item.price).toFixed(2)} ‚Ç¨</strong>
                                            </td>
                                            <td>
                                                {invoice.items.length > 1 && (
                                                    <button
                                                        className="remove-item-btn"
                                                        onClick={() => removeItem(index)}
                                                    >
                                                        ‚úï
                                                    </button>
                                                )}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                            <button className="add-item-btn" onClick={addItem}>
                                + Ajouter un article
                            </button>
                        </div>

                        <div className="form-group">
                            <label className="form-label">Notes / Conditions</label>
                            <textarea
                                className="form-input"
                                value={invoice.notes}
                                onChange={(e) => setInvoice({...invoice, notes: e.target.value})}
                                placeholder="Notes suppl√©mentaires, conditions de paiement..."
                                rows="3"
                                style={{resize: 'vertical'}}
                            />
                        </div>
                    </div>

                    <div className="invoice-summary">
                        <div className="summary-row">
                            <span>Sous-total</span>
                            <strong>{calculateSubtotal().toFixed(2)} ‚Ç¨</strong>
                        </div>
                        <div className="summary-row">
                            <span>TVA (20%)</span>
                            <strong>{calculateTax().toFixed(2)} ‚Ç¨</strong>
                        </div>
                        <div className="summary-row total">
                            <span>TOTAL</span>
                            <span>{calculateTotal().toFixed(2)} ‚Ç¨</span>
                        </div>
                    </div>

                    <div className="action-buttons">
                        <button className="btn btn-primary" onClick={handleSave}>
                            üíæ Enregistrer la facture
                        </button>
                        <button className="btn btn-secondary" onClick={onCancel}>
                            Annuler
                        </button>
                    </div>
                </div>
            );
        }

        // Invoice List Component
        function InvoiceList({ invoices, onViewInvoice }) {
            if (invoices.length === 0) {
                return (
                    <div className="empty-state">
                        <div className="empty-state-icon">üìÑ</div>
                        <h3>Aucune facture</h3>
                        <p>Cr√©ez votre premi√®re facture pour commencer</p>
                    </div>
                );
            }

            return (
                <div className="invoice-list">
                    {invoices.map((invoice, index) => (
                        <div key={index} className="invoice-card" onClick={() => onViewInvoice(invoice)}>
                            <div className="invoice-info">
                                <h3>{invoice.number}</h3>
                                <p>{invoice.clientName} ‚Ä¢ {invoice.date}</p>
                            </div>
                            <div className="invoice-amount">
                                {invoice.total.toFixed(2)} ‚Ç¨
                            </div>
                        </div>
                    ))}
                </div>
            );
        }

        // Main App Component
        function App() {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState('create');
            const [invoices, setInvoices] = useState([]);

            // Load invoices from localStorage
            useEffect(() => {
                const saved = localStorage.getItem('invoices');
                if (saved) {
                    setInvoices(JSON.parse(saved));
                }
            }, []);

            const handleLogin = (userData) => {
                setUser(userData);
            };

            const handleLogout = () => {
                setUser(null);
            };

            const handleSaveInvoice = (invoice) => {
                const newInvoices = [...invoices, invoice];
                setInvoices(newInvoices);
                localStorage.setItem('invoices', JSON.stringify(newInvoices));
                setActiveTab('list');
            };

            const handleViewInvoice = (invoice) => {
                generatePDF(invoice);
            };

            const generatePDF = (invoice) => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                // Header
                doc.setFillColor(102, 126, 234);
                doc.rect(0, 0, 210, 40, 'F');
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(24);
                doc.text('FACTURE', 20, 25);

                // Invoice details
                doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.text(`Num√©ro: ${invoice.number}`, 140, 20);
                doc.text(`Date: ${invoice.date}`, 140, 27);
                doc.text(`√âch√©ance: ${invoice.dueDate}`, 140, 34);

                // Client info
                doc.setFontSize(12);
                doc.setFont(undefined, 'bold');
                doc.text('Factur√© √†:', 20, 55);
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                doc.text(invoice.clientName, 20, 62);
                doc.text(invoice.clientEmail, 20, 68);
                doc.text(invoice.clientAddress, 20, 74);

                // Items table
                let yPos = 95;
                doc.setFillColor(243, 244, 246);
                doc.rect(20, yPos, 170, 10, 'F');
                doc.setFont(undefined, 'bold');
                doc.text('Description', 25, yPos + 7);
                doc.text('Qt√©', 120, yPos + 7);
                doc.text('Prix unit.', 140, yPos + 7);
                doc.text('Total', 170, yPos + 7);

                yPos += 15;
                doc.setFont(undefined, 'normal');
                invoice.items.forEach(item => {
                    doc.text(item.description, 25, yPos);
                    doc.text(item.quantity.toString(), 125, yPos);
                    doc.text(`${item.price.toFixed(2)} ‚Ç¨`, 140, yPos);
                    doc.text(`${(item.quantity * item.price).toFixed(2)} ‚Ç¨`, 165, yPos);
                    yPos += 7;
                });

                // Summary
                yPos += 10;
                doc.line(140, yPos, 190, yPos);
                yPos += 7;
                doc.text('Sous-total:', 140, yPos);
                doc.text(`${invoice.subtotal.toFixed(2)} ‚Ç¨`, 170, yPos);
                yPos += 7;
                doc.text('TVA (20%):', 140, yPos);
                doc.text(`${invoice.tax.toFixed(2)} ‚Ç¨`, 170, yPos);
                yPos += 10;
                doc.setFont(undefined, 'bold');
                doc.setFontSize(14);
                doc.text('TOTAL:', 140, yPos);
                doc.text(`${invoice.total.toFixed(2)} ‚Ç¨`, 165, yPos);

                // Notes
                if (invoice.notes) {
                    yPos += 20;
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'bold');
                    doc.text('Notes:', 20, yPos);
                    doc.setFont(undefined, 'normal');
                    doc.text(invoice.notes, 20, yPos + 7, { maxWidth: 170 });
                }

                doc.save(`${invoice.number}.pdf`);
            };

            if (!user) {
                return <LoginPage onLogin={handleLogin} />;
            }

            return (
                <div className="app-container">
                    <div className="dashboard">
                        <div className="header">
                            <h1 className="header-title">üìÑ G√©n√©rateur de Factures</h1>
                            <div className="user-info">
                                <span className="user-name">üëã {user.name}</span>
                                <button className="logout-btn" onClick={handleLogout}>
                                    D√©connexion
                                </button>
                            </div>
                        </div>

                        <div className="content">
                            <div className="tabs">
                                <button
                                    className={`tab ${activeTab === 'create' ? 'active' : ''}`}
                                    onClick={() => setActiveTab('create')}
                                >
                                    ‚úèÔ∏è Cr√©er une facture
                                </button>
                                <button
                                    className={`tab ${activeTab === 'list' ? 'active' : ''}`}
                                    onClick={() => setActiveTab('list')}
                                >
                                    üìã Mes factures ({invoices.length})
                                </button>
                            </div>

                            {activeTab === 'create' && (
                                <InvoiceForm
                                    onSave={handleSaveInvoice}
                                    onCancel={() => setActiveTab('list')}
                                />
                            )}

                            {activeTab === 'list' && (
                                <InvoiceList
                                    invoices={invoices}
                                    onViewInvoice={handleViewInvoice}
                                />
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
